# Mitsubishi CNC ALL.PRM Parser

![–ü—Ä–∏–º–µ—Ä Excel-–æ—Ç—á—ë—Ç–∞](docs/screenshots/screenshot_001.png)

–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è **–∏–Ω–∂–µ–Ω–µ—Ä–æ–≤ –∏ –Ω–∞–ª–∞–¥—á–∏–∫–æ–≤** –ß–ü–£ Mitsubishi —Å–µ—Ä–∏–∏ **M800**, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π:

- –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å —Ñ–∞–π–ª –±—ç–∫–∞–ø–∞ `ALL.PRM` –≤ —É–¥–æ–±–Ω—ã–π **Excel-–¥–æ–∫—É–º–µ–Ω—Ç**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Å—Ç–∞–≤–ª—è—Ç—å **–æ–ø–∏—Å–∞–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤** –∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞
- –û—Ç–æ–±—Ä–∞–∂–∞—Ç—å –æ—Å–∏ –∫–∞–∫ **X, Y, Z, A, C** –≤–º–µ—Å—Ç–æ `A1, A2, A3...`
- –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ **—Å—Ä–∞–≤–Ω–µ–Ω–∏—è –≤–µ—Ä—Å–∏–π** (–≤ –±—É–¥—É—â–µ–º)

> üí° –ù–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –±—ã—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–æ–º ‚Äî –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–∞–∑–æ–≤—ã—Ö –Ω–∞–≤—ã–∫–æ–≤ —Ä–∞–±–æ—Ç—ã —Å –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–æ–π.

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Python
- –°–∫–∞—á–∞–π—Ç–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ **Python 3.8 –∏–ª–∏ –Ω–æ–≤–µ–µ** —Å [–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å–∞–π—Ç–∞](https://www.python.org/downloads/)
- –ü—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –æ—Ç–º–µ—Ç—å—Ç–µ** –≥–∞–ª–æ—á–∫—É **"Add Python to PATH"**

### 2. –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
–û—Ç–∫—Ä–æ–π—Ç–µ **–ö–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É (cmd)** –∏–ª–∏ **PowerShell** –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞
cd –ø—É—Ç—å/–∫/mitsubishi_cnc_prm_parser

# –°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
python -m venv venv

# –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –µ–≥–æ
# Windows (PowerShell):
.\venv\Scripts\Activate.ps1
# Windows (cmd):
venv\Scripts\activate.bat
# Linux/macOS:
source venv/bin/activate
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–±–∏–±–ª–∏–æ—Ç–µ–∫–∏)
```bash
pip install -r requirements.txt
```

> üìù –§–∞–π–ª `requirements.txt` —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å—ë –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ: –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `openpyxl` –∏ `PyYAML`.

### 4. –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –≤—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã
- –ü–æ–º–µ—Å—Ç–∏—Ç–µ –≤–∞—à —Ñ–∞–π–ª `ALL.PRM` (—Å–Ω—è—Ç—ã–π —Å –ß–ü–£) –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞
- (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –¥–æ–±–∞–≤—å—Ç–µ `descriptions.yaml` —Å –æ–ø–∏—Å–∞–Ω–∏—è–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–ª–∏ –≤–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å —Ç–µ–º —á—Ç–æ –µ—Å—Ç—å –≤ –ø—Ä–æ–µ–∫—Ç–µ

## üõ† –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ë–∞–∑–æ–≤—ã–π –ø–∞—Ä—Å–∏–Ω–≥ (–≤—ã–≤–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª—å)

```bash
python main.py
# –ò—â–µ—Ç ALL.PRM –∏ descriptions.yaml –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
```

![–í—ã–≤–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª—å](docs/screenshots/screenshot_002.png)

### –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel

```bash
# –ò—Å–ø–æ–ª—å–∑—É—è ALL.PRM –∏–∑ —Ç–µ–∫—É—â–µ–π –ø–∞–ø–∫–∏
python main.py -o output.xlsx

# –£–∫–∞–∑–∞—Ç—å —Ñ–∞–π–ª –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ —è–≤–Ω–æ
python main.py backup.PRM -o report.xlsx
```

> –ï—Å–ª–∏ –≤—Å—ë —Ö–æ—Ä–æ—à–æ —É–≤–∏–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ: `‚úÖ –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel –∑–∞–≤–µ—Ä—à—ë–Ω: output.xlsx`

### –° –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –æ–ø–∏—Å–∞–Ω–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∑–∏—Ç descriptions.yaml
python main.py ALL.PRM -o full_report.xlsx

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–≤–æ–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ my_params.yaml
python main.py ALL.PRM -o report.xlsx --descriptions my_params.yaml
```

### –° –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –∏–º—ë–Ω –æ—Å–µ–π (X, Y, Z –≤–º–µ—Å—Ç–æ A1, A2, A3)

```bash
# –î–æ–±–∞–≤—å—Ç–µ –∞—Ä–≥—É–º–µ–Ω—Ç --axis-names
python main.py ALL.PRM -o with_axis_names.xlsx --axis-names
```

> üîç –ò–º–µ–Ω–∞ –æ—Å–µ–π –±–µ—Ä—É—Ç—Å—è –∏–∑ **—Å–∞–º–æ–≥–æ —Ñ–∞–π–ª–∞ ALL.PRM**, –∏–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ **1013Ax** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `N1013A1PX` ‚Üí –æ—Å—å `A1 = X`) 

### üÜö –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–≤—É—Ö —Ñ–∞–π–ª–æ–≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (diff)

–° –ø–æ–º–æ—â—å—é —É—Ç–∏–ª–∏—Ç—ã `diff.py` –≤—ã –º–æ–∂–µ—Ç–µ **—Å—Ä–∞–≤–Ω–∏—Ç—å –¥–≤–∞ —Ñ–∞–π–ª–∞** `ALL.PRM` (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–æ –∏ –ø–æ—Å–ª–µ –Ω–∞–ª–∞–¥–∫–∏) –∏ –ø–æ–ª—É—á–∏—Ç—å **Excel-–æ—Ç—á—ë—Ç —Å —Ä–∞–∑–ª–∏—á–∏—è–º–∏**.

#### –ü—Ä–æ—Å—Ç–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ

```bash
python diff.py backup_old.PRM backup_new.PRM
```
–†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Ñ–∞–π–ª `diff.xlsx` (–∏–º—è —Ñ–∞–π–ª–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é).

#### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∏–º–µ–Ω–∏ –æ—Ç—á—ë—Ç–∞

```bash
python diff.py v1.PRM v2.PRM -o —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ_–Ω–∞–ª–∞–¥–∫–∏.xlsx
```

#### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –æ–ø–∏—Å–∞–Ω–∏–π –∏ –∏–º—ë–Ω –æ—Å–µ–π

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å —Ñ–∞–π–ª `descriptions.yaml` –∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –≤–∏–¥–µ—Ç—å **–æ–ø–∏—Å–∞–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤** –∏ **–æ—Å–∏ –∫–∞–∫ X/Y/Z**, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:

```bash
python diff.py old.PRM new.PRM -o report.xlsx --descriptions descriptions.yaml --axis-names
```

> üí° –§–∞–π–ª `descriptions.yaml` –∏—â–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ —Ç–µ–∫—É—â–µ–π –ø–∞–ø–∫–µ, –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω —è–≤–Ω–æ —á–µ—Ä–µ–∑ `--descriptions`. 

#### –ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç `diff.xlsx`
- **–ó–µ–ª—ë–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏** ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, **–¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ** –≤ –Ω–æ–≤–æ–º —Ñ–∞–π–ª–µ.
- **–ö—Ä–∞—Å–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏** ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, **—É–¥–∞–ª—ë–Ω–Ω—ã–µ** –∏–∑ –Ω–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞.
- **–û–±—ã—á–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏** ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, **–∑–Ω–∞—á–µ–Ω–∏–µ –∫–æ—Ç–æ—Ä—ã—Ö –∏–∑–º–µ–Ω–∏–ª–æ—Å—å**.
- –ö–æ–ª–æ–Ω–∫–∏:
`Parameter`, `Axis`, `Tool`, `Keep`, `Value (old)`, `Value (new)`, `Changed`, `Description`


## üìä –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞

### ‚úÖ –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

| –§—É–Ω–∫—Ü–∏—è | –°—Ç–∞—Ç—É—Å |
| --- | --- |
| –ü–∞—Ä—Å–∏–Ω–≥ `ALL.PRM` | ‚úÖ |
| –≠–∫—Å–ø–æ—Ä—Ç –≤ **Excel** —Å –∑–∞–∫—Ä–µ–ø–ª—ë–Ω–Ω–æ–π —à–∞–ø–∫–æ–π | ‚úÖ |
| –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ –ª–∏—Å—Ç–∞–º: General, Axis, Tool, Keep | ‚úÖ |
| –ü–æ–¥–¥–µ—Ä–∂–∫–∞ `--axis-names` (X/Y/Z –≤–º–µ—Å—Ç–æ A1/A2/A3) | ‚úÖ |
| –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ `descriptions.yaml` | ‚úÖ |
| –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ | ‚úÖ |
| –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–≤—É—Ö `ALL.PRM` —Ñ–∞–π–ª–æ–≤ (**diff**-—É—Ç–∏–ª–∏—Ç–∞) | ‚úÖ |

## ‚è≥ –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è

| –§—É–Ω–∫—Ü–∏—è | –°—Ç–∞—Ç—É—Å |
| --- | --- |
| –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è `README.md` | ‚úÖ (–≤—ã –µ—ë —á–∏—Ç–∞–µ—Ç–µ) |

## üìÅ –§–æ—Ä–º–∞—Ç —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ `descriptions.yaml`

```yaml
1001:
  group: "–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ç–∞–Ω–∫–∞"
  subgroup: "01 –ë–∞–∑–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã"
  shortname: "SYS_ON"
  description: "–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–∏—Å—Ç–µ–º—ã"
1013:
  group: "–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ç–∞–Ω–∫–∞"
  subgroup: "02 –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –±–∞–∑–æ–≤–æ–π –æ—Å–∏"
  shortname: "axname"
  description: "–ò–º—è –æ—Å–∏"
```

> üí° –í—ã –º–æ–∂–µ—Ç–µ –Ω–∞—á–∞—Ç—å —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å—Ç—Ä–æ–∫ –∏ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –¥–æ–ø–æ–ª–Ω—è—Ç—å —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫. 

## üìé –õ–∏—Ü–µ–Ω–∑–∏—è
–ü—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ –ª–∏—Ü–µ–Ω–∑–∏–∏ **MIT** ‚Äî –≤—ã –º–æ–∂–µ—Ç–µ —Å–≤–æ–±–æ–¥–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ –≤ –ª–∏—á–Ω—ã—Ö –∏ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏—Ö —Ü–µ–ª—è—Ö.

> üîß **–°–æ–≤–µ—Ç**: –µ—Å–ª–∏ –≤—ã —Ä–∞–±–æ—Ç–∞–µ—Ç–µ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Å—Ç–∞–Ω–∫–∞–º–∏ ‚Äî —Å–æ–∑–¥–∞–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—É—é –ø–∞–ø–∫—É –¥–ª—è –∫–∞–∂–¥–æ–≥–æ, —á—Ç–æ–±—ã –Ω–µ –ø—É—Ç–∞—Ç—å `ALL.PRM` –∏ `descriptions.yaml`. 


## üì• –ö–∞–∫ —Å–∫–∞—á–∞—Ç—å –ø—Ä–æ–µ–∫—Ç —Å GitHub (–±–µ–∑ Git)
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è: üëâ https://github.com/GerSmith/mitsubishi_cnc_prm_parser
2. –ù–∞–∂–º–∏—Ç–µ –∑–µ–ª—ë–Ω—É—é –∫–Ω–æ–ø–∫—É `Code` ‚Üí `Download ZIP`
3. –†–∞—Å–ø–∞–∫—É–π—Ç–µ –∞—Ä—Ö–∏–≤ –≤ —É–¥–æ–±–Ω—É—é –ø–∞–ø–∫—É
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–∞—Ä—Å–µ—Ä, –∫–∞–∫ –æ–ø–∏—Å–∞–Ω–æ –≤—ã—à–µ
